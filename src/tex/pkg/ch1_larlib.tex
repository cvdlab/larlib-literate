\documentclass[10pt]{book}
\usepackage{cite}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amsfonts}
\hypersetup{colorlinks = true}

\author{Alberto Paoluzzi, Francesco Furiani, Giulio Martella}
\title{Linear Algebraic Representation}

\begin{document}

\frontmatter
\maketitle
\tableofcontents

\mainmatter

\chapter{Introduction}

@O lib/jl/LARLIB.jl
@{function lar2plasm(EV, FE)
    EV = sparse(EV)
    faces = Array{Array{Int64, 1}, 1}()

    for f in 1:size(FE, 1)

        verts = Array{Int64, 1}()
        done = Array{Int64, 1}()
        face = FE[f, :]
        edges = EV[face.nzind, :]

        push!(done, 1)
        vs = edges[1, :].nzind
        if face.nzval[1] < 0
            vs = vs[end:-1:1]
        end
        startv, nextv = vs
        push!(verts, startv)

        while nextv != startv
            
            e = setdiff(edges[:, nextv].nzind, done)[1]
            push!(done, e)
            vs = edges[e, :].nzind
            if face.nzval[e] < 0
                vs = vs[end:-1:1]
            end
            curv, nextv = vs
            push!(verts, curv)
        end

        push!(faces, verts)
    end

    "FV = " * string(faces)[15:end]
end

function lar2py(V, EV)
    text = "V = [[0,0]"
    for i in 1:size(V, 1)
        text = text * "," * string(vec(V[i, :]))
    end
    text = text * "]\n"
    
    text = text * "EV = ["
    for i in 1:size(EV, 1)
        if i > 1 text = text * "," end
        text = text * string(EV[i, :].nzind)
    end
    text = text * "]"
    return text
end

function generate_cube_lines(ne)
    nv = ne*2
    
    V = Array{Float64, 2}(nv, 2)
    as = 2*pi*rand(nv)
    for i in 1:nv
        a = as[i]
        V[i, :] = [.5*cos(a)+.5 .5*sin(a)+.5]
    end
    
    V = [V; .25 .25; .75 .25; .75 .75; .25 .75]
    

    EV = spzeros(Int8, 4+ne, nv+4)
    EV[1:4, nv+1:nv+4] = [1 1 0 0; 0 1 1 0; 0 0 1 1; 1 0 0 1]
    for i in 1:ne
        EV[4+i, 2*i-1:2*i] = 1
    end
    
    V, EV
end


function generate_short_lines(n)
    origins = rand(n, 2)
    directions = mapslices(normalize, rand(n, 2) - .5*ones(n, 2), 2)
    alphas = .1*rand(n)+.05
    new_points = Array{Float64, 2}(n, 2)
    for i in 1:n
        new_points[i, :] = origins[i, :] + alphas[i]*directions[i, :]
    end
    V = [origins; new_points]
    EV = spzeros(Int8, n, n*2)
    for i in 1:n
        EV[i, i] = 1
        EV[i, n+i] = 1
    end
    V, EV
end
@}


\backmatter


\bibliography{book}{}
\bibliographystyle{plain}
\end{document}
